//table of 2^0 to 2^127 256 steps
static const __uint128_t tabp2 [128]{
(__uint128_t)1,
(__uint128_t)2<<0,
(__uint128_t)2<<1,
(__uint128_t)2<<2,
(__uint128_t)2<<3,
(__uint128_t)2<<4,
(__uint128_t)2<<5,
(__uint128_t)2<<6,
(__uint128_t)2<<7,
(__uint128_t)2<<8,
(__uint128_t)2<<9,
(__uint128_t)2<<10,
(__uint128_t)2<<11,
(__uint128_t)2<<12,
(__uint128_t)2<<13,
(__uint128_t)2<<14,
(__uint128_t)2<<15,
(__uint128_t)2<<16,
(__uint128_t)2<<17,
(__uint128_t)2<<18,
(__uint128_t)2<<19,
(__uint128_t)2<<20,
(__uint128_t)2<<21,
(__uint128_t)2<<22,
(__uint128_t)2<<23,
(__uint128_t)2<<24,
(__uint128_t)2<<25,
(__uint128_t)2<<26,
(__uint128_t)2<<27,
(__uint128_t)2<<28,
(__uint128_t)2<<29,
(__uint128_t)2<<30,
(__uint128_t)2<<31,
(__uint128_t)2<<32,
(__uint128_t)2<<33,
(__uint128_t)2<<34,
(__uint128_t)2<<35,
(__uint128_t)2<<36,
(__uint128_t)2<<37,
(__uint128_t)2<<38,
(__uint128_t)2<<39,
(__uint128_t)2<<40,
(__uint128_t)2<<41,
(__uint128_t)2<<42,
(__uint128_t)2<<43,
(__uint128_t)2<<44,
(__uint128_t)2<<45,
(__uint128_t)2<<46,
(__uint128_t)2<<47,
(__uint128_t)2<<48,
(__uint128_t)2<<49,
(__uint128_t)2<<50,
(__uint128_t)2<<51,
(__uint128_t)2<<52,
(__uint128_t)2<<53,
(__uint128_t)2<<54,
(__uint128_t)2<<55,
(__uint128_t)2<<56,
(__uint128_t)2<<57,
(__uint128_t)2<<58,
(__uint128_t)2<<59,
(__uint128_t)2<<60,
(__uint128_t)2<<61,
(__uint128_t)2<<62,
(__uint128_t)2<<63,
(__uint128_t)2<<64,
(__uint128_t)2<<65,
(__uint128_t)2<<66,
(__uint128_t)2<<67,
(__uint128_t)2<<68,
(__uint128_t)2<<69,
(__uint128_t)2<<70,
(__uint128_t)2<<71,
(__uint128_t)2<<72,
(__uint128_t)2<<73,
(__uint128_t)2<<74,
(__uint128_t)2<<75,
(__uint128_t)2<<76,
(__uint128_t)2<<77,
(__uint128_t)2<<78,
(__uint128_t)2<<79,
(__uint128_t)2<<80,
(__uint128_t)2<<81,
(__uint128_t)2<<82,
(__uint128_t)2<<83,
(__uint128_t)2<<84,
(__uint128_t)2<<85,
(__uint128_t)2<<86,
(__uint128_t)2<<87,
(__uint128_t)2<<88,
(__uint128_t)2<<89,
(__uint128_t)2<<90,
(__uint128_t)2<<91,
(__uint128_t)2<<92,
(__uint128_t)2<<93,
(__uint128_t)2<<94,
(__uint128_t)2<<95,
(__uint128_t)2<<96,
(__uint128_t)2<<97,
(__uint128_t)2<<98,
(__uint128_t)2<<99,
(__uint128_t)2<<100,
(__uint128_t)2<<101,
(__uint128_t)2<<102,
(__uint128_t)2<<103,
(__uint128_t)2<<104,
(__uint128_t)2<<105,
(__uint128_t)2<<106,
(__uint128_t)2<<107,
(__uint128_t)2<<108,
(__uint128_t)2<<109,
(__uint128_t)2<<110,
(__uint128_t)2<<111,
(__uint128_t)2<<112,
(__uint128_t)2<<113,
(__uint128_t)2<<114,
(__uint128_t)2<<115,
(__uint128_t)2<<116,
(__uint128_t)2<<117,
(__uint128_t)2<<118,
(__uint128_t)2<<119,
(__uint128_t)2<<120,
(__uint128_t)2<<121,
(__uint128_t)2<<122,
(__uint128_t)2<<123,
(__uint128_t)2<<124,
(__uint128_t)2<<125,
(__uint128_t)2<<126
};

//floor(log2(n))
inline int ui128log2(__uint128_t n)  
{  
    return 
		(n < tabp2[1]   ?0 :   
		(n < tabp2[2]   ?1 :   
		(n < tabp2[3]   ?2 :   
		(n < tabp2[4]   ?3 :   
		(n < tabp2[5]   ?4 :   
		(n < tabp2[6]   ?5 :   
		(n < tabp2[7]   ?6 :   
		(n < tabp2[8]   ?7 :   
		(n < tabp2[9]   ?8 :   
		(n < tabp2[10]  ?9 :   
		(n < tabp2[11]  ?10 :   
		(n < tabp2[12]  ?11 :   
		(n < tabp2[13]  ?12 :   
		(n < tabp2[14]  ?13 :   
		(n < tabp2[15]  ?14 :   
		(n < tabp2[16]  ?15 :   
		(n < tabp2[17]  ?16 :   
		(n < tabp2[18]  ?17 :   
		(n < tabp2[19]  ?18 :   
		(n < tabp2[20]  ?19 :   
		(n < tabp2[21]  ?20 :   
		(n < tabp2[22]  ?21 :   
		(n < tabp2[23]  ?22 :   
		(n < tabp2[24]  ?23 :   
		(n < tabp2[25]  ?24 :   
		(n < tabp2[26]  ?25 :   
		(n < tabp2[27]  ?26 :   
		(n < tabp2[28]  ?27 :   
		(n < tabp2[29]  ?28 :   
		(n < tabp2[30]  ?29 :   
		(n < tabp2[31]  ?30 :   
		(n < tabp2[32]  ?31 :   
		(n < tabp2[33]  ?32 :   
		(n < tabp2[34]  ?33 :   
		(n < tabp2[35]  ?34 :   
		(n < tabp2[36]  ?35 :   
		(n < tabp2[37]  ?36 :   
		(n < tabp2[38]  ?37 :   
		(n < tabp2[39]  ?38 :   
		(n < tabp2[40]  ?39 :   
		(n < tabp2[41]  ?40 :   
		(n < tabp2[42]  ?41 :   
		(n < tabp2[43]  ?42 :   
		(n < tabp2[44]  ?43 :   
		(n < tabp2[45]  ?44 :   
		(n < tabp2[46]  ?45 :   
		(n < tabp2[47]  ?46 :   
		(n < tabp2[48]  ?47 :   
		(n < tabp2[49]  ?48 :   
		(n < tabp2[50]  ?49 :   
		(n < tabp2[51]  ?50 :   
		(n < tabp2[52]  ?51 :   
		(n < tabp2[53]  ?52 :   
		(n < tabp2[54]  ?53 :   
		(n < tabp2[55]  ?54 :   
		(n < tabp2[56]  ?55 :   
		(n < tabp2[57]  ?56 :   
		(n < tabp2[58]  ?57 :   
		(n < tabp2[59]  ?58 :   
		(n < tabp2[60]  ?59 :   
		(n < tabp2[61]  ?60 :   
		(n < tabp2[62]  ?61 :   
		(n < tabp2[63]  ?62 :   
		(n < tabp2[64]  ?63 :   
		(n < tabp2[65]  ?64 :   
		(n < tabp2[66]  ?65 :   
		(n < tabp2[67]  ?66 :   
		(n < tabp2[68]  ?67 :   
		(n < tabp2[69]  ?68 :   
		(n < tabp2[70]  ?69 :   
		(n < tabp2[71]  ?70 :   
		(n < tabp2[72]  ?71 :   
		(n < tabp2[73]  ?72 :   
		(n < tabp2[74]  ?73 :   
		(n < tabp2[75]  ?74 :   
		(n < tabp2[76]  ?75 :   
		(n < tabp2[77]  ?76 :   
		(n < tabp2[78]  ?77 :   
		(n < tabp2[79]  ?78 :   
		(n < tabp2[80]  ?79 :   
		(n < tabp2[81]  ?80 :   
		(n < tabp2[82]  ?81 :   
		(n < tabp2[83]  ?82 :   
		(n < tabp2[84]  ?83 :   
		(n < tabp2[85]  ?84 :   
		(n < tabp2[86]  ?85 :   
		(n < tabp2[87]  ?86 :   
		(n < tabp2[88]  ?87 :   
		(n < tabp2[89]  ?88 :   
		(n < tabp2[90]  ?89 :   
		(n < tabp2[91]  ?90 :   
		(n < tabp2[92]  ?91 :   
		(n < tabp2[93]  ?92 :   
		(n < tabp2[94]  ?93 :   
		(n < tabp2[95]  ?94 :   
		(n < tabp2[96]  ?95 :   
		(n < tabp2[97]  ?96 :   
		(n < tabp2[98]  ?97 :   
		(n < tabp2[99]  ?98 :   
		(n < tabp2[100] ?99 :   
		(n < tabp2[101] ?100 :   
		(n < tabp2[102] ?101 :   
		(n < tabp2[103] ?102 :   
		(n < tabp2[104] ?103 :   
		(n < tabp2[105] ?104 :   
		(n < tabp2[106] ?105 :   
		(n < tabp2[107] ?106 :   
		(n < tabp2[108] ?107 :   
		(n < tabp2[109] ?108 :   
		(n < tabp2[110] ?109 :   
		(n < tabp2[111] ?110 :   
		(n < tabp2[112] ?111 :   
		(n < tabp2[113] ?112 :   
		(n < tabp2[114] ?113 :   
		(n < tabp2[115] ?114 :   
		(n < tabp2[116] ?115 :   
		(n < tabp2[117] ?116 :   
		(n < tabp2[118] ?117 :   
		(n < tabp2[119] ?118 :   
		(n < tabp2[120] ?119 :   
		(n < tabp2[121] ?120 :   
		(n < tabp2[122] ?121 :   
		(n < tabp2[123] ?122 :   
		(n < tabp2[124] ?123 :   
		(n < tabp2[125] ?124 :   
		(n < tabp2[126] ?125 :   
        (n < tabp2[127] ?126 :
        	 tabp2[128]
		)))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))));
}
